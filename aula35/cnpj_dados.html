<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consulta CNPJ</title>
    <style>
        label {
            display: block;
            margin-top: 10px;
        }
        input[type="text"] {
            width: 300px;
            padding: 5px;
        }
        button {
            margin-top: 10px;
            padding: 5px 10px;
        }
    </style>
</head>
<body>
    <h1>Consulta CNPJ</h1>
    <label for="cnpj">CNPJ:</label>
    <input type="text" id="cnpj" name="cnpj" maxlength="18" onkeyup="mascararCNPJ(this)" onblur="consultar()">
    <label for="razao_social">Razão Social:</label>
    <input type="text" id="razao_social" name="razao_social">
    <label for="tipo">Cep:</label>
    <input type="text" id="cep" name="cep" onkeyup="mascararCEP(this)">    
    <label for="endereco">Endereço:</label>
    <input type="text" id="logradouro" name="logradouro">
    <label for="numero">Numero:</label>
    <input type="text" id="numero" name="numero">
    <label for="complemento">Complemento:</label>
    <input type="text" id="complemento" name="complemento">    
    <label for="bairro">Bairro:</label>
    <input type="text" id="bairro" name="bairro">
    <label for="municipio">Municipio:</label>
    <input type="text" id="municipio" name="municipio">
    <label for="UF">UF:</label>
    <input type="text" id="uf" name="uf">    

    <script>
        async function consultar() {
            const cnpj = document.getElementById('cnpj').value;
            const response = await fetch(`https://minhareceita.org/numero/${cnpj}`);
            // Outra API que você pode usar é: https://publica.cnpj.ws/cnpj/{cnpj}
            // Mas os nomes dos campos são diferentes.
            const data = await response.json();

            document.getElementById('razao_social').value = data.razao_social;
            document.getElementById('cep').value = formatarCEP(data.cep);
            document.getElementById('logradouro').value = data.descricao_tipo_de_logradouro + ' ' + data.logradouro;
            document.getElementById('numero').value = data.numero;
            document.getElementById('complemento').value = data.complemento;
            document.getElementById('bairro').value = data.bairro;
            document.getElementById('municipio').value = data.municipio;
            document.getElementById('uf').value = data.uf;
            
        }
    </script>
    <script>
        function mascararCNPJ(elemento) {
            let valor = elemento.value.replace(/\D/g, ""); // Remove caracteres não numéricos

            if (valor.length <= 14) {
                valor = valor.replace(/^(\d{2})(\d)/, "$1.$2");
                valor = valor.replace(/^(\d{2})\.(\d{3})(\d)/, "$1.$2.$3");
                valor = valor.replace(/^(\d{2})\.(\d{3})\.(\d{3})(\d)/, "$1.$2.$3/$4");
                valor = valor.replace(/^(\d{2})\.(\d{3})\.(\d{3})\/(\d{4})(\d)/, "$1.$2.$3/$4-$5");
          }

            elemento.value = valor;
        }

        function formatarCEP(cep) {
          return cep.replace(/^(\d{5})(\d{3})$/, '$1-$2');
        }
                                                                                                                                
    </script>    
</body>
</html>
